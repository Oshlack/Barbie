"0","# trim samples as you need. "
"0","week4_test <- trimObjectByMetadata(Barbie = week4_top, "
"0","                                    condition = ""treat"", specified = ""IT"", "
"0","                                    keep = FALSE) # exclude ""IT"" samples"
"0","week4_test <- trimObjectByMetadata(Barbie = week4_test, "
"0","                                    condition = ""lineage"", specified = ""immature"", "
"0","                                    keep = FALSE) # exclude ""immature"" celltype from samples"
"0",""
"0","# customize sample groups as you need for comparison in the following test."
"0","Vector_customized <- week4_test$metadata$lineage"
"0","Vector_customized[Vector_customized %in% c(""Bcell"", ""Tcell"")] <- ""Lymphoid""# group samples"
"0",""
"0","# make your own targets and design matrix"
"0","  # targets"
"0","  mytargets <- data.frame(week4_test$metadata, category = Vector_customized)"
"0",""
"0","  # model design matrix"
"0","  mydesign <- mytargets %>%"
"0","    with(model.matrix(~0 + category + treat + mouse + tissue))"
"0",""
"0","# apply test for Bias_Prop"
"0","week4_test <- getPropBiasGroup(Barbie = week4_test, mydesign = mydesign)"
"1","[1]"
"1"," ""Design matrix full rank? TRUE"""
"1","
"
"1","[1]"
"1"," ""Consensus correlation:  0.410557145917892"""
"1","
"
"0","kableExtra::kable(week4_test$Bias_Prop)"
